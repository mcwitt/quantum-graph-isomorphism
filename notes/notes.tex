%        File: notes.tex
%     Created: Tue Jan 08 11:00 AM 2013 P
% Last Change: Tue Jan 08 11:00 AM 2013 P
%
\input{header.tex}
\usepackage{hyperref}

\newcommand{\ham}{H}
\newcommand{\nnsum}[2]{\sum_{\langle #1 #2 \rangle}}
\newcommand{\cc}{\mathrm{c.c.}}
\newcommand{\nghbr}[2]{a(#1,\,#2)}

\begin{document}

\section*{Definitions}

\begin{equation}
  \ham = (1 - s) \ham_D + s \ham_P,
  \qquad
  0 \leq s \leq 1
  \label{def-h_qaa}
\end{equation}
\begin{equation}
  \ham_D = \sum_i \sigma^x_i
  \label{def-h_d}
\end{equation}
\begin{equation}
  \ham_P = \nnsum{i}{j} \sigma^z_i \sigma^z_j + \sum_i h_i \sigma^z_i,
  \qquad
  h_i \rightarrow h
  \label{def-h_p}
\end{equation}
\begin{equation}
  f_{ij} = \pd{}{h_j} \avg{\sigma^z_i}
  \sim \avg{\sigma^z_i \sigma^z_j}
  \label{def-f}
\end{equation}

Can approximate derivative using finite differences. (Peter's method for
calculating susceptibility using Lanczos?)

Numerical methods to consider:
\begin{enumerate}
  \item \href{http://en.wikipedia.org/wiki/Lanczos_algorithm}
    {Lanczos algorithm} (matrix diagonalization)
  \item \href{http://en.wikipedia.org/wiki/Conjugate_gradient_method}
    {Conjugate gradient method} (find ground state only)
  \item Power method
\end{enumerate}

\section*{Perturbation theory for susceptibility}

Calculate $f_{ij}$ in first-order nondegenerate perturbation theory.

Let $\ket{\psi}$ be the ground state.
\begin{equation}
  \pd{}{h_j} \avg{\sigma_i}
  = \matrixel{\pd{\psi}{h_j}}{\sigma_i}{\psi} + \cc
  \label{}
\end{equation}
Let
$h_j \rightarrow h_j + \delta h_j$.
Then
$\ham_P \rightarrow \ham_P + \delta h_j \sigma_j$.
The first-order change in the ground state is
\begin{equation}
  \ket{\psi^{(1)}}
  = \delta h_j \sum_{n>0} \frac{\matrixel{n}{\sigma_j}{\psi}}{E_0 - E_n} \ket{n}.
  \label{}
\end{equation}
Therefore
\begin{align}
  \ket{\pd{\psi}{h_j}}
  &= \lim_{\delta h_j \rightarrow 0} \frac{1}{\delta h_j} \ket{\psi^{(1)}} \\
  &= \sum_{n>0} \frac{\matrixel{n}{\sigma_j}{\psi}}{E_0 - E_n} \ket{n}
  \label{}
\end{align}
and
\begin{equation}
  \pd{}{h_j} \avg{\sigma_i}
  = -2 \avg{\sigma_j \sum_{n>0} \frac{\ket{n} \bra{n}}{E_n - E_0} \sigma_i}
  \label{}
\end{equation}
where $\avg{\cdots}$ is the ground-state expectation value.

\begin{equation}
  \ham = \sum_n E_n \ket{n} \bra{n}
  \label{}
\end{equation}
Let
\begin{equation}
  \boxed{
  \ham^{\prime} \equiv \ham - E_0 \ket{\psi} \bra{\psi}
  }
  \label{}
\end{equation}
Then
\begin{equation}
  \ham^{\prime} - E_0 = \sum_{n>0} \left( E_n - E_0 \right) \ket{n} \bra{n}
  \label{}
\end{equation}
and
\begin{equation}
  \boxed{
  \pd{}{h_j} \avg{\sigma_i}
  = -2 \avg{\sigma_j \left( \ham^{\prime} - E_0 \right)^{-1} \sigma_i}
  }
  \label{}
\end{equation}

\section*{Energy}

\begin{equation}
  \ham = (1 - s) \avg{\ham_D} + s \avg{\ham_P}
  \label{}
\end{equation}
Expand the ground state $\ket{\psi}$ in an orthonormal basis
\begin{equation}
  \ket{\psi} = \sum_{n=0}^{2^N-1} c_n \ket{n},
  \qquad
  \sum_n \abs{c_n}^2 = 1
  \label{}
\end{equation}
where $\ket{n}$ is an eigenstate of
$\sigma_1 \otimes \sigma_2 \otimes \cdots \otimes \sigma_N$
such that
\begin{equation}
    \sum_{i=0}^N \left( \sigma_i + \frac{1}{2} \right) 2^i \ket{n} = n \ket{n}.
  \label{}
\end{equation}
In words, $\ket{n}$ corresponds to the spin configuration obtained by taking 1
as spin up and 0 as spin down in the binary representation of $n$.
For example, with $N=3$,
\begin{align*}
  \ket{0} \equiv \ket{000}
  &\equiv
  \ket{\downarrow} \otimes
  \ket{\downarrow} \otimes
  \ket{\downarrow} \\
  \ket{1} \equiv \ket{001}
  &\equiv
  \ket{\downarrow} \otimes
  \ket{\downarrow} \otimes
  \ket{\uparrow} \\
  &\vdots \\
  \ket{7} \equiv \ket{111}
  &\equiv
  \ket{\uparrow} \otimes
  \ket{\uparrow} \otimes
  \ket{\uparrow}.
  \label{}
\end{align*}
Because $\ham$ is real and symmetric in this basis, we can restrict the
coefficients $c_n$ to be real
\begin{equation}
  c_n = c_n^*.
  \label{}
\end{equation}
The driver Hamiltonian $\ham_D$ connects states that differ by a single spin
flip. Let
\begin{equation}
  A_{n m}
  \equiv \matrixel{n}{\ham_D}{m}
  \equiv \begin{cases}
    1 & \ket{n}, \ket{m} \text{ differ by a single spin flip} \\
    0
  \end{cases}
  \label{}
\end{equation}
For each state $\ket{n}$ there are $N$ ``neighboring'' states that differ by a
single spin flip. Let $\ket{\nghbr{n}{i}}$ denote the $i$th neighbor of
$\ket{n}$, so that
\begin{equation}
  \sum_m A_{n m} c_m \equiv \sum_{i=1}^N c_{\nghbr{n}{i}}.
  \label{}
\end{equation}
Then
\begin{equation}
  \avg{\ham_D}
  = \sum_{n,\,m} c_n A_{n m} c_m
  \equiv \sum_n \sum_{i=1}^N c_n c_{\nghbr{n}{i}}.
  \label{}
\end{equation}
The problem Hamiltonian $\ham_P$ is diagonal in the computational basis
\begin{equation}
  \ham_P \ket{n} = E_n \ket{n}
  \label{}
\end{equation}
\begin{equation}
  \avg{\ham_P} = \sum_n E_n c_n^2
  \label{}
\end{equation}
The function to be minimized is
\begin{equation}
  \boxed{
  f \left( \left\{ c_i \right\} \right)
  \equiv \avg{\ham}
  = \frac{(1-s) \sum_n \sum_{i=1}^N c_n c_{\nghbr{n}{i}} + s \sum_n E_n c_n^2}
  {\sum_n c_n^2}
  }
  \label{}
\end{equation}
\section*{Gradient of energy}
\end{document}


%        File: notes.tex
%     Created: Tue Jan 08 11:00 AM 2013 P
% Last Change: Tue Jan 08 11:00 AM 2013 P
%
\input{header.tex}
\usepackage{hyperref}

\newcommand{\ham}{\mathcal{H}}
\newcommand{\nnsum}[2]{\sum_{\langle #1 #2 \rangle}}
\newcommand{\cc}{\mathrm{c.c.}}

\begin{document}

\section*{Definitions}

\begin{equation}
  \ham = (1 - s) \ham_D + s \ham_P,
  \qquad
  0 \leq s \leq 1
  \label{def-h_qaa}
\end{equation}
\begin{equation}
  \ham_D = \sum_i \sigma^x_i
  \label{def-h_d}
\end{equation}
\begin{equation}
  \ham_P = \nnsum{i}{j} \sigma^z_i \sigma^z_j + \sum_i h_i \sigma^z_i,
  \qquad
  h_i \rightarrow h
  \label{def-h_p}
\end{equation}
\begin{equation}
  f_{ij} = \pd{}{h_j} \avg{\sigma^z_i}
  \sim \avg{\sigma^z_i \sigma^z_j}
  \label{def-f}
\end{equation}

Can approximate derivative using finite differences. (Peter's method for
calculating susceptibility using Lanczos?)

Numerical methods to consider:
\begin{enumerate}
  \item \href{http://en.wikipedia.org/wiki/Lanczos_algorithm}
    {Lanczos algorithm} (matrix diagonalization)
  \item \href{http://en.wikipedia.org/wiki/Conjugate_gradient_method}
    {Conjugate gradient method} (find ground state only)
  \item Power method
\end{enumerate}

\section*{Perturbation theory for susceptibility}

Calculate $f_{ij}$ in first-order nondegenerate perturbation theory.

Let $\ket{\psi}$ be the ground state.
\begin{equation}
  \pd{}{h_j} \avg{\sigma_i}
  = \matrixel{\pd{\psi}{h_j}}{\sigma_i}{\psi} + \cc
  \label{}
\end{equation}
Let
$h_j \rightarrow h_j + \delta h_j$.
Then
$\ham_P \rightarrow \ham_P + \delta h_j \sigma_j$.
The first-order change in the ground state is
\begin{equation}
  \ket{\psi^{(1)}}
  = \delta h_j \sum_{n>0} \frac{\matrixel{n}{\sigma_j}{\psi}}{E_0 - E_n} \ket{n}.
  \label{}
\end{equation}
Therefore
\begin{align}
  \ket{\pd{\psi}{h_j}}
  &= \frac{1}{\delta h_j} \ket{\psi^{(1)}} \\
  &= \sum_{n>0} \frac{\matrixel{n}{\sigma_j}{\psi}}{E_0 - E_n} \ket{n}
  \label{}
\end{align}
and
\begin{equation}
  \pd{}{h_j} \avg{\sigma_i}
  = -2 \matrixel{\psi} {\sigma_j \sum_{n>0} \frac{\ket{n} \bra{n}}{E_n - E_0} \sigma_i} {\psi}
  \label{}
\end{equation}

\begin{equation}
  \ham = \sum_n E_n \ket{n} \bra{n}
  \label{}
\end{equation}
Let
\begin{equation}
  \boxed{
  \ham^{\prime} \equiv \ham - E_0 \ket{\psi} \bra{\psi}
  }
  \label{}
\end{equation}
Then
\begin{equation}
  \ham^{\prime} - E_0 = \sum_{n>0} \left( E_n - E_0 \right) \ket{n} \bra{n}
  \label{}
\end{equation}
and
\begin{equation}
  \boxed{
  \pd{}{h_j} \avg{\sigma_i}
  = -2 \matrixel{\psi}{\sigma_j \left( \ham^{\prime} - E_0 \right)^{-1} \sigma_i}{\psi}
  }
  \label{}
\end{equation}

\section*{Energy expectation value}

\begin{equation}
  \ham = (1 - s) \avg{\ham_D} + s \avg{\ham_P}
  \label{}
\end{equation}

\begin{equation}
  \ket{\psi} = \sum_{i=0}^{2^n-1} c_i \ket{i}
  \label{}
\end{equation}
where $\ket{i}$ is an eigenstate of
$\sigma_1 \otimes \sigma_2 \otimes \cdots \otimes \sigma_n$
such that
\begin{equation}
  i = \sum_{j=0}^n \left( \sigma_j + \frac{1}{2} \right) 2^j.
  \label{}
\end{equation}
For example, with $n=3$
\begin{align*}
  \ket{0} \equiv \ket{000}
  &\equiv
  \ket{\downarrow} \otimes
  \ket{\downarrow} \otimes
  \ket{\downarrow} \\
  \ket{1} \equiv \ket{001}
  &\equiv
  \ket{\downarrow} \otimes
  \ket{\downarrow} \otimes
  \ket{\uparrow} \\
  &\vdots \\
  \ket{7} \equiv \ket{111}
  &\equiv
  \ket{\uparrow} \otimes
  \ket{\uparrow} \otimes
  \ket{\uparrow}.
  \label{}
\end{align*}
The driver Hamiltonian $\ham_D$ connects states that differ by one and only one
spin flip.
\begin{equation}
  \matrixel{i}{H_D}{j} = \sum_{k=1}^n \delta_{i,\, n_{jk}}
  \label{}
\end{equation}
\begin{align}
  \avg{\ham_D}
  &= \sum_{i,\,j} c_i^* c_j \matrixel{i}{\ham_D}{j} \\
  &= \sum_{i,\,j} \sum_{k=1}^n c_i^* c_j \delta_{i,\, n_{jk}} \\
  &= \sum_j \sum_{k=1}^n c_{n_{jk}}^* c_j
  \label{}
\end{align}
\begin{equation}
  \boxed{
  \avg{\ham_D} = \sum_i \sum_{j=1}^n c_{n_{ij}}^* c_i
  }
  \label{}
\end{equation}
\end{document}

